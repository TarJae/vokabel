### shiny module that implements the state machine ###